{% extends 'base.html' %}

{% load static %}

{% block title %}
    Index
{% endblock title %}

{% block content %}
    <section class="image-search-section mt50px">
        <form method="GET" class="image-search__form">
            <label class="rounded-input-container flex js ac">
                <input name="search" class=" p14px" type="text" placeholder="Something.."/>
                <button class="button ml5px">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                        <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path>
                    </svg>
                </button>
            </label>
        </form>
    </section>
    <section class="image-detail mt50px">
        <div class="flex jc">
            <div class="image-detail__info panel mb20px">
                <a class="account-info flex jc ac p06rem" href="{% url 'main:cabinet' image.author.username %}">
                    <img class="avatar" src="{% static 'img/goose.jpg ' %}" alt="Account image"/>
                    <p class="full-name ml05rem">{{ image.author.first_name }} {{ image.author.last_name }}</p>
                </a>
                <span class="created-time p06rem">{{ image.created_at }}</span>
            </div>
            <div class="image-detail__image mb20px">
                <button class="top-image-options button rating-button upvote" data-pk="{{ image.pk }}">
                    <svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24">
                        <path d="M16.5 3c-1.74 0-3.41.81-4.5 2.09C10.91 3.81 9.24 3 7.5 3 4.42 3 2 5.42 2 8.5c0 3.78 3.4 6.86 8.55 11.54L12 21.35l1.45-1.32C18.6 15.36 22 12.28 22 8.5 22 5.42 19.58 3 16.5 3zm-4.4 15.55l-.1.1-.1-.1C7.14 14.24 4 11.39 4 8.5 4 6.5 5.5 5 7.5 5c1.54 0 3.04.99 3.57 2.36h1.87C13.46 5.99 14.96 5 16.5 5c2 0 3.5 1.5 3.5 3.5 0 2.89-3.14 5.74-7.9 10.05z"></path>
                    </svg>
                </button>
                <img src="{{ image }}" />
                <div class="flex jc bottom-image-options">
                    <button class="button button--white mr15px">Report</button>
                    <button class="button download button--blue middle">Download</button>
                    <button class="button button--white ml15px">Get license</button>
                </div>
            </div>
            <div class="image-detail__edit">
                {% if moderator or image.author == request.user %}
                    <div class="edit-tags mt10px">
                        <form id="edit-tags" method="post" class="edit-tags__form">
                            {% csrf_token %}
                            <div class="tags">
                                {{ form.errors.tags }}
                                <div class="bottom-content mt5px">
                                    {{ form.tags }}
                                </div>
                            </div>
                        </form>
                        <form id="delete-image" action="{% url 'main:delete_image' slug=image.slug %}" method="post">
                            {% csrf_token %}
                        </form>
                        <div class="edit-tags__buttons mt15px">
                            <button type="submit" name="edit" class="button button--blue small mr10px" form="edit-tags">Save changes</button>
                            <button type="submit" name="delete" class="button button--red small" onclick="return confirm('Are you sure you want to delete this item?');" form="delete-image">Delete image</button>
                        </div>
                    </div>
                {% else %}
                    <div class="tags-panel flex js ac">
                        {% for tag in image.tags.all %}
                            <div class="tag flex js ac mr5px">
                                <a class="tag-name" href="{% url "main:images_list_by_tag" tag.slug %}">{{ tag }}</a>
                            </div>
                        {% endfor %}
                    </div>
                {% endif %}
                <div class="colors-panel flex js ac mt15px">
                    <span class="colors-span">Colors:</span>
                    {% for color in colors %}
                        <a class="color ml5px" href="{% url 'main:home' %}?color={{ color|urlencode }}" style="background: {{ color }}"></a>
                    {% endfor %}
                </div>
            </div>
        </div>
    </section>
    <section class="images-section flex jc ac mt50px">
        <h1 class="mb20px">SIMILAR IMAGES</h1>
        <ul class="images-list flex js as">
            {% for column in columns %}
                <li class="image-column"></li>
            {% endfor %}
            {% include "image-block.html" with images=similar_images %}
        </ul>
    </section>
{% endblock content %}

{% block js %}
    <script src="{% static 'js/modules/functions/image_columns.js' %}"></script>
    <script src="{% static 'js/modules/classes/ImageApi.js' %}"></script>
    <script src="{% static 'js/detailed_image_view.js' %}"></script>
    {{ form.media }}
{% endblock %}